---
title: "demo_trasie_CS"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{demo_trasie_CS}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(DAISIE)
```
I show TRASIE_CS here:


Here I create params:

```{r}
n_mainland_species <- 50
island_age <- 2
n_replicates <- 10

clado_rate <- 2 # cladogenesis rate
ext_rate <- 2 # extinction rate
clade_carr_cap <- 10 # clade-level carrying capacity
imm_rate <- 1 # immigration rate
ana_rate <- 1 # anagenesis rate

Tpars_check <- create_trait_state_params(
     trans_rate = 0,
     immig_rate2 = imm_rate,
     ext_rate2 = ext_rate,
     ana_rate2 = ana_rate,
     clado_rate2 = clado_rate,
     trans_rate2 = 0,
     M2 = n_mainland_species)

Tpars_same <- create_trait_state_params(
     trans_rate = 0,
     immig_rate2 = imm_rate,
     ext_rate2 = ext_rate,
     ana_rate2 = ana_rate,
     clado_rate2 = clado_rate,
     trans_rate2 = 0,
     M2 = n_mainland_species * 0.5)
```

Here I check TRASIE can create the same simulated rusults as DAISIE using same rate values:

```{r}
set.seed(42)
DAISIE <- DAISIE_sim( 
  time = island_age,
  M = n_mainland_species, 
  pars = c(clado_rate, ext_rate, clade_carr_cap, imm_rate, ana_rate),
  replicates = n_replicates,
  Tpars = NULL,    ##  DAISIE only considering one trait states, so Tpars = NULL
  plot_sims = FALSE,
  verbose = FALSE,
  Apars = NULL,
  divdepmodel = "CS"
)

set.seed(42)   ## pars is empty, Tpars use same rate values
TRASIE_check <- DAISIE_sim( 
  time = island_age,
  M = 0, 
  pars = c(0, 0, clade_carr_cap, 0, 0),
  replicates = n_replicates,
  Tpars = Tpars_check,   ## all species on mainland with state 2
  plot_sims = FALSE,
  verbose = FALSE,
  Apars = NULL,
  divdepmodel = "CS"
)

set.seed(42)
TRASIE_same <- DAISIE_sim( 
  time = island_age,
  M = n_mainland_species * 0.5, 
  pars = c(clado_rate, ext_rate, clade_carr_cap, imm_rate, ana_rate),
  replicates = n_replicates,
  Tpars = Tpars_same,   ## all species on mainland with state 2
  plot_sims = FALSE,
  verbose = FALSE,
  Apars = NULL,
  divdepmodel = "CS"
)
```
Here I show the plots:

```{r fig.width=5, fig.height=5}
DAISIE_plot_sims(island_replicates = DAISIE,Tpars = NULL, use_dev_new = FALSE)
```
```{r fig.width=5, fig.height=5}
DAISIE_plot_sims(island_replicates = TRASIE_check,Tpars = Tpars_check, use_dev_new = FALSE)
```
```{r fig.width=5, fig.height=5}
DAISIE_plot_sims(island_replicates = TRASIE_same,Tpars = Tpars_same, use_dev_new = FALSE)
```

For CS model, if diversification rates for two trait states are same, M and M2 will not influence the result when M + M2 is a constant.







