<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Luis M. Valente, Albert B. Phillimore, Rampal S. Etienne" />

<meta name="date" content="2015-05-19" />

<title>Demo simulating islands</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Demo simulating islands</h1>
<h4 class="author">Luis M. Valente, Albert B. Phillimore, Rampal S. Etienne</h4>
<h4 class="date">19 May 2015</h4>



<div id="daisie-dynamic-assembly-of-island-biotas-through-speciation-immigration-and-extinction" class="section level1">
<h1>DAISIE – Dynamic Assembly of Island biotas through Speciation, Immigration and Extinction</h1>
<p>Citation: Valente LM, Phillimore AB, Etienne RS (2015) Equilibrium and non- equilibrium dynamics simultaneously operate in the Galápagos islands. Ecology Letters, 18(8), 844-852. <a href="https://doi.org/10.1111/ele.12461" class="uri">https://doi.org/10.1111/ele.12461</a>.</p>
<div id="data-table" class="section level2">
<h2>3.2 Data table</h2>
<p>To load the package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(DAISIE)</a></code></pre></div>
</div>
<div id="simulating-islands" class="section level2">
<h2>3.5 Simulating islands</h2>
<p>The function <code>DAISIE_sim</code> allows simulation of DAISIE models and plots the results. The user specifies the parameters to be simulated, the number of replicates, the length of the simulation (typically the island age), and the number of species in the mainland pool.</p>
<p>When the plot_sims option is set to the default (TRUE) the function will produce a species- through-time plot showing the accumulation of total, endemic and non-endemic species through time, as well as confidence intervals for the total number of species.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">n_mainland_species &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">island_age &lt;-<span class="st"> </span><span class="dv">4</span></a></code></pre></div>
<p>To shorten the run-time of this vignette, reduce the number of <code>n_replicates</code>. For increased accuracy, increase this number.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">n_replicates &lt;-<span class="st"> </span><span class="dv">10</span></a></code></pre></div>
<div id="example-5.1-simulating-10-islands-with-no-diversity-dependence-all-species-sharing-the-same-parameters-and-plotting-the-results" class="section level3">
<h3>Example 5.1 – Simulating 10 islands with no diversity-dependence, all species sharing the same parameters, and plotting the results</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">42</span>)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">clado_rate &lt;-<span class="st"> </span><span class="fl">2.550687345</span> <span class="co"># cladogenesis rate</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">ext_rate &lt;-<span class="st"> </span><span class="fl">2.683454548</span> <span class="co"># extinction rate</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">clade_carr_cap &lt;-<span class="st"> </span><span class="ot">Inf</span> <span class="co"># clade-level carrying capacity</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">imm_rate &lt;-<span class="st"> </span><span class="fl">0.00933207</span> <span class="co"># immigration rate</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">ana_rate &lt;-<span class="st"> </span><span class="fl">1.010073119</span> <span class="co"># anagenesis rate</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">island_replicates &lt;-<span class="st"> </span><span class="kw">DAISIE_sim</span>( </a>
<a class="sourceLine" id="cb5-8" data-line-number="8">  <span class="dt">time =</span> island_age,</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  <span class="dt">M =</span> n_mainland_species, </a>
<a class="sourceLine" id="cb5-10" data-line-number="10">  <span class="dt">pars =</span> <span class="kw">c</span>(clado_rate, ext_rate, clade_carr_cap, imm_rate, ana_rate),</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  <span class="dt">replicates =</span> n_replicates,</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">  <span class="dt">plot_sims =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">  <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">  <span class="dt">Apars =</span> <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15">)</a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="kw">DAISIE_plot_sims</span>(<span class="dt">island_replicates =</span> island_replicates, <span class="dt">use_dev_new =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>The object <code>island_replicates</code> contains the results of the simulation in DAISIE format. 10 islands are stored in the object, and each island replicate can be viewed separately. For example, type <code>island_replicates[[1]]</code> to view the first replicate.</p>
<p>The element of the list relating to each island contains a table with the number of species through time, as well as branching time information for each independent colonisation event extant at the end of the simulation.</p>
</div>
<div id="example-5.2-simulating-10-islands-with-diversity-dependence-k10-all-species-sharing-the-same-parameters-and-plotting-the-results" class="section level3">
<h3>Example 5.2 – Simulating 10 islands with diversity-dependence (K’=10), all species sharing the same parameters, and plotting the results</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">clado_rate &lt;-<span class="st"> </span><span class="fl">2.550687345</span> <span class="co"># cladogenesis rate</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">ext_rate &lt;-<span class="st"> </span><span class="fl">2.683454548</span> <span class="co"># extinction rate</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">clade_carr_cap &lt;-<span class="st"> </span><span class="fl">10.0</span>  <span class="co"># clade-level carrying capacity</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">imm_rate &lt;-<span class="st"> </span><span class="fl">0.00933207</span> <span class="co"># immigration rate</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">ana_rate &lt;-<span class="st"> </span><span class="fl">1.010073119</span> <span class="co"># anagenesis rate</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">island_replicates_K &lt;-<span class="st"> </span><span class="kw">DAISIE_sim</span>( </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">  <span class="dt">time =</span> island_age, </a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  <span class="dt">M =</span> n_mainland_species, </a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  <span class="dt">pars =</span> <span class="kw">c</span>(clado_rate, ext_rate, clade_carr_cap, imm_rate, ana_rate),</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  <span class="dt">replicates =</span> n_replicates,</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  <span class="dt">plot_sims =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  <span class="dt">verbose =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">) </a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="kw">DAISIE_plot_sims</span>(island_replicates_K, <span class="dt">use_dev_new =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="example-5.3-simulating-10-islands-allowing-darwins-finches-to-have-a-higher-rate-of-cladogenesis" class="section level3">
<h3>Example 5.3 – Simulating 10 islands allowing Darwin’s finches to have a higher rate of cladogenesis:</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">clado_rate_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">0.38</span> <span class="co"># cladogenesis rate</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">ext_rate_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">0.55</span> <span class="co"># extinction rate</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">clade_carr_cap_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="ot">Inf</span>  <span class="co"># clade-level carrying capacity</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">imm_rate_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">0.04</span> <span class="co"># immigration rate</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">ana_rate_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">1.10</span> <span class="co"># anagenesis rate</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">clado_rate_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="fl">0.38</span> <span class="co"># cladogenesis rate</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">ext_rate_<span class="dv">2</span> &lt;-<span class="st"> </span>ext_rate_<span class="dv">1</span> <span class="co"># extinction rate</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9">clade_carr_cap_<span class="dv">2</span> &lt;-<span class="st"> </span>clade_carr_cap_<span class="dv">1</span>  <span class="co"># clade-level carrying capacity</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">imm_rate_<span class="dv">2</span> &lt;-<span class="st"> </span>imm_rate_<span class="dv">1</span> <span class="co"># immigration rate</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11">ana_rate_<span class="dv">2</span> &lt;-<span class="st"> </span>ana_rate_<span class="dv">1</span> <span class="co"># anagenesis rate</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">island_replicates_2types &lt;-<span class="st"> </span><span class="kw">DAISIE_sim</span>( </a>
<a class="sourceLine" id="cb7-14" data-line-number="14">  <span class="dt">time =</span> island_age,</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">  <span class="dt">M =</span> n_mainland_species, </a>
<a class="sourceLine" id="cb7-16" data-line-number="16">  <span class="dt">pars =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">    clado_rate_<span class="dv">1</span>, ext_rate_<span class="dv">1</span>, clade_carr_cap_<span class="dv">1</span>, imm_rate_<span class="dv">1</span>, ana_rate_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">    clado_rate_<span class="dv">2</span>, ext_rate_<span class="dv">2</span>, clade_carr_cap_<span class="dv">2</span>, imm_rate_<span class="dv">2</span>, ana_rate_<span class="dv">2</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19">  ),</a>
<a class="sourceLine" id="cb7-20" data-line-number="20">  <span class="dt">replicates =</span> n_replicates, </a>
<a class="sourceLine" id="cb7-21" data-line-number="21">  <span class="dt">prop_type2_pool =</span> <span class="fl">0.163</span>,</a>
<a class="sourceLine" id="cb7-22" data-line-number="22">  <span class="dt">plot_sims =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb7-23" data-line-number="23">  <span class="dt">verbose =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24">)</a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="kw">DAISIE_plot_sims</span>(island_replicates_2types, <span class="dt">use_dev_new =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>This produces a figure similar to Fig. 2, with three plots: one for the total number of species, one for species of type 1 and one for species of type 2. Accessing each island replicate individually (e.g. island_replicates_2types[[15]]) shows information on branching times and species-through-time tables for total, type 1 species and type 2 species.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
